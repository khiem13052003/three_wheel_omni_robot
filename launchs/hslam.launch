<?xml version="1.0"?>
<launch>
  <!-- Các tham số chung -->

  <!-- Không dùng simulated time -->
  <param name="/use_sim_time" value="false"/>

  <!-- 1) Đảm bảo có TF odom→base_link trước khi Hector khởi chạy -->
  <!-- <node pkg="tf" type="static_transform_publisher" name="odom_to_base_link_broadcaster"
        args="0 0 0 0 0 0 $(arg odom_frame) $(arg base_frame) 100"/> -->

  <!-- 2) Hector SLAM chính -->
  <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">
    <!-- Frame names -->
    <param name="map_frame"                          value="map"/>
    <param name="base_frame"                         value="base_link"/>
    <param name="odom_frame"                         value="odom"/>

    <!-- Sử dụng TF scan transform -->
    <param name="pub_map_odom_transform"             value="true"/>
    <param name="pub_map_scanmatch_transform"             value="false"/>

    <!-- Kích thước bản đồ -->
    <param name="map_resolution"                     value="0.05"/>
    <param name="map_size"                           value="1024"/>
    <param name="map_start_x"                        value="0.5"/>
    <param name="map_start_y"                        value="0.5"/>
    <param name="map_multi_res_levels"               value="2"/>

    <!-- Tham số cập nhật bản đồ -->
    <param name="update_factor_free"                 value="0.04"/>
    <param name="update_factor_occupied"             value="0.9"/>
    <param name="map_update_distance_thresh"         value="0.04"/>
    <param name="map_update_angle_thresh"            value="0.06"/>
    <param name="laser_z_min_value"                  value="-1.0"/>
    <param name="laser_z_max_value"                  value="1.0"/>

    <!-- Cấu hình scan -->
    <param name="scan_subscriber_queue_size"         value="10"/>

  </node>


  <!-- 6) RViz -->
  <node pkg="rviz" type="rviz" name="rviz"
        args="-d $(find hector_slam_launch)/rviz_cfg/mapping_demo.rviz"
        output="screen"/>
</launch>
